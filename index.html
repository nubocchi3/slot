<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã‚¹ãƒ­ãƒƒãƒˆ</title>

<style>
body {
    font-family: Arial, sans-serif;
    text-align: center;
    background-color: #f0f0f0;
    margin: 0;
    padding: 20px;
}

#coins {
    font-size: 1.3rem;
    margin-bottom: 10px;
}

.slot-container {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-bottom: 15px;
}

.reel {
    width: 80px;
    height: 100px;
    background: white;
    border: 4px solid #333;
    border-radius: 8px;
    font-size: 3rem;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* ğŸ‰ æ¼”å‡º */
.win {
    animation: glow 0.8s infinite alternate;
}

@keyframes glow {
    from { box-shadow: 0 0 5px gold; }
    to { box-shadow: 0 0 20px gold; }
}

.bigwin {
    animation: shake 0.2s infinite;
}

@keyframes shake {
    0% { transform: translate(0, 0); }
    25% { transform: translate(5px, 0); }
    50% { transform: translate(-5px, 0); }
    75% { transform: translate(5px, 0); }
    100% { transform: translate(0, 0); }
}

button {
    padding: 10px 30px;
    font-size: 1.2rem;
    background-color: #ff4757;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

button:disabled {
    background-color: #ccc;
}

table {
    margin: 15px auto;
    border-collapse: collapse;
    background: white;
}

th, td {
    border: 2px solid #333;
    padding: 6px 12px;
}
</style>
</head>

<body>

<h1>ğŸ° ç°¡æ˜“ã‚¹ãƒ­ãƒƒãƒˆ</h1>

<div id="coins"></div>

<div class="slot-container" id="slotArea">
    <div class="reel" id="reel1">?</div>
    <div class="reel" id="reel2">?</div>
    <div class="reel" id="reel3">?</div>
</div>

<button id="spinBtn">ã‚¹ãƒ”ãƒ³ï¼ï¼ˆ5ã‚³ã‚¤ãƒ³ï¼‰</button>
<div id="message"></div>

<table>
<tr><th>çµµæŸ„</th><th>ç¢ºç‡</th><th>ã‚³ã‚¤ãƒ³</th></tr>
<tr><td>7ï¸âƒ£</td><td>0.1%</td><td>7777</td></tr>
<tr><td>ğŸ’</td><td>0.9%</td><td>500</td></tr>
<tr><td>â­</td><td>1.2%</td><td>50</td></tr>
<tr><td>ğŸ””</td><td>5%</td><td>30</td></tr>
<tr><td>ğŸ’</td><td>15.8%</td><td>10</td></tr>
<tr><th colspan="3">ãƒã‚ºãƒ¬ï¼š77%</th></tr>
</table>

<script>
const reels = [
    document.getElementById("reel1"),
    document.getElementById("reel2"),
    document.getElementById("reel3")
];

const slotArea = document.getElementById("slotArea");
const spinBtn = document.getElementById("spinBtn");
const message = document.getElementById("message");
const coinDisplay = document.getElementById("coins");

const playCost = 5;

/* ğŸ’¾ ã‚³ã‚¤ãƒ³ä¿å­˜ */
let coins = Number(localStorage.getItem("slotCoins")) || 100;

function saveCoins() {
    localStorage.setItem("slotCoins", coins);
}

function updateCoins() {
    coinDisplay.textContent = `æ‰€æŒã‚³ã‚¤ãƒ³ï¼š${coins}`;
    saveCoins();
}

/* ğŸ”Š ã‚µã‚¦ãƒ³ãƒ‰ */
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function playSound(freq, time) {
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.frequency.value = freq;
    osc.type = "square";
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();
    gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + time);
    osc.stop(audioCtx.currentTime + time);
}

/* ğŸ¯ ç¢ºç‡ãƒ†ãƒ¼ãƒ–ãƒ« */
const prizeTable = [
    { symbol: "7ï¸âƒ£", rate: 0.1, reward: 7777, big: true },
    { symbol: "ğŸ’", rate: 0.9, reward: 500 },
    { symbol: "â­", rate: 1.2, reward: 50 },
    { symbol: "ğŸ””", rate: 5.0, reward: 30 },
    { symbol: "ğŸ’", rate: 15.8, reward: 10 }
];

function lottery() {
    let r = Math.random() * 100;
    let sum = 0;
    for (const p of prizeTable) {
        sum += p.rate;
        if (r < sum) return p;
    }
    return null;
}

/* ğŸ° ã‚¹ãƒ”ãƒ³ */
spinBtn.onclick = () => {
    if (coins < playCost) {
        message.textContent = "ã‚³ã‚¤ãƒ³ä¸è¶³ï¼";
        return;
    }

    coins -= playCost;
    updateCoins();
    spinBtn.disabled = true;
    message.textContent = "å›è»¢ä¸­â€¦";

    reels.forEach(r => r.className = "reel");
    slotArea.classList.remove("bigwin");

    let count = 0;
    const spin = setInterval(() => {
        reels.forEach(r => r.textContent = "â“");
        playSound(400, 0.05);
        if (++count > 12) {
            clearInterval(spin);
            checkResult();
            spinBtn.disabled = false;
        }
    }, 100);
};

function checkResult() {
    const prize = lottery();

    if (prize) {
        reels.forEach(r => {
            r.textContent = prize.symbol;
            r.classList.add("win");
        });

        coins += prize.reward;
        updateCoins();

        if (prize.big) {
            slotArea.classList.add("bigwin");
            playSound(1200, 0.8);
        } else {
            playSound(800, 0.4);
        }

        message.textContent = `ğŸ‰ +${prize.reward}ã‚³ã‚¤ãƒ³ï¼`;
    } else {
        reels.forEach(r => r.textContent = "âŒ");
        message.textContent = "ãƒã‚ºãƒ¬â€¦";
    }
}

updateCoins();
</script>

</body>
</html>
